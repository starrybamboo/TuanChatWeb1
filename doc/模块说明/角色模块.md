# 角色模块说明

## 概述

角色模块是TuanChat平台的核心功能之一，允许用户浏览、创建和管理角色。角色可以在剧本创作和游玩过程中被使用，是连接创作者和玩家的重要桥梁。

## 数据模型

### 角色头像 (RoleAvatar)

```typescript
export type RoleAvatar = {
    roleId?: number;      // 角色ID
    avatarId?: number;    // 头像ID
    avatarTitle?: string; // 头像标题
    avatarUrl?: string;   // 头像URL
    spriteUrl?: string;   // 精灵图URL
    createTime?: string;  // 创建时间
    updateTime?: string;  // 更新时间
};
```

### 角色头像请求 (RoleAvatarRequest)

```typescript
export type RoleAvatarRequest = {
    roleId?: number;      // 角色ID
    avatarId?: number;    // 头像ID
    avatarTitle?: string; // 头像标题
    avatarUrl?: string;   // 头像URL
    spriteUrl?: string;   // 精灵图URL
};
```

## 功能模块

### 角色列表

- 展示所有可用角色
- 支持分页加载
- 提供筛选和排序功能
- 角色卡片展示基本信息

### 角色详情

- 展示角色完整信息
- 显示角色头像和精灵图
- 提供角色背景故事和属性信息
- 展示角色相关的剧本和模组

### 角色创建与编辑

- 角色基本信息编辑
- 头像上传和裁剪
- 精灵图设置
- 角色属性和标签设置

### 角色管理

- 角色列表管理
- 批量操作功能
- 角色权限设置
- 角色版本历史

## 界面设计

### 角色列表页

角色列表页采用网格布局，每个角色以卡片形式展示，包含：

- 角色头像
- 角色名称
- 创建者信息
- 简短描述
- 操作按钮（查看详情、编辑等）

### 角色详情页

角色详情页分为多个区域：

- 头部：角色名称、创建者、创建时间等基本信息
- 主体：角色详细描述、背景故事、属性列表
- 侧边：相关剧本和模组推荐
- 底部：评论和讨论区

### 角色编辑页

角色编辑页提供表单界面，包含：

- 基本信息编辑区
- 头像上传和预览区
- 精灵图设置区
- 属性和标签编辑区
- 背景故事富文本编辑器

## 技术实现

### 前端组件

- 角色列表组件 (RoleList)
- 角色卡片组件 (RoleCard)
- 角色详情组件 (RoleDetail)
- 角色编辑表单 (RoleForm)
- 头像上传组件 (AvatarUploader)

### API接口

- 获取角色列表：GET /api/roles
- 获取角色详情：GET /api/roles/{id}
- 创建角色：POST /api/roles
- 更新角色：PUT /api/roles/{id}
- 删除角色：DELETE /api/roles/{id}
- 上传角色头像：POST /api/roles/{id}/avatar

### 状态管理

使用Pinia进行状态管理，创建专门的角色状态存储：

```typescript
// 角色状态存储示例
const useRoleStore = defineStore('role', {
  state: () => ({
    roles: [],
    currentRole: null,
    loading: false,
    error: null
  }),
  actions: {
    async fetchRoles() { /* ... */ },
    async fetchRoleById(id) { /* ... */ },
    async createRole(roleData) { /* ... */ },
    async updateRole(id, roleData) { /* ... */ },
    async deleteRole(id) { /* ... */ }
  }
});
```

## 未来规划

### 短期计划

- 实现基础的角色列表和详情页
- 完成角色创建和编辑功能
- 集成头像上传和处理

### 中期计划

- 添加角色标签和分类系统
- 实现角色搜索和高级筛选
- 开发角色评分和评论功能

### 长期计划

- 角色市场功能，支持角色交易
- 角色定制化AI生成功能
- 角色社区和创作者激励机制